<link rel="stylesheet" href="css/styles.css"/>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Ghosty Games - Unblocked Games</title>
</head>
<body>
    <header>
        <a href="index.html"></a>
        <img src="Images/NEWGhostyGames.png" class="logo" alt="Logo" style="width:180px;height:150px;">
        <h1>Placeholder</h1>
        <nav>
            <a href="index.html">Home</a>
            <a href="about.html">About</a>
            <a href="contact.html">Contact</a>
            <a href="donate.html">Donate</a>
        </nav>

        <div class="login-container" id="login-container">
            <button id="login-button">
                <a href="login.html" id="login">Log In</a>
            </button>
        </div>

                <div id="profile-container" style="display:none;" class="profile-dropdown">
                    <button class="profile-btn" id="profile-btn">Profile ▼</button>
                    <div class="profile-menu" id="profile-menu">
                        <p><strong>Email:</strong> <span id="profile-email"></span></p>
                        <input type="text" id="username-prefix" placeholder="Enter custom username">
                        <button class="save-btn" id="save-username">Save Username</button>
                        <button class="logout-btn" id="logout-button">Log Out</button>
                    </div>
                </div>

        <div class="search-container">
            <input type="text" placeholder="Search games..." id="search-input">
            <button id="search-button">Search</button>
        </div>
    </header>

    <main>
        <h1>Donate To Ghosty Games</h1>
        <p>Your support helps us keep the site running and ad-free. Thank you!</p>
<div class="donate-button" id="donate-button-container">
            <button id="donate-button">
                <a href="https://ko-fi.com/ghostygames#payment-widget" id="donate">Donate</a>
            </button>
        </div>
    </main>

    <footer>
        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6480692859796192"
            crossorigin="anonymous"></script>
        <ins class="adsbygoogle"
            style="display:block"
            data-ad-client="ca-pub-6480692859796192"
            data-ad-slot="5049938623"
            data-ad-format="auto"
            data-full-width-responsive="true"></ins>
        <script>
            (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
    </footer>
    <footer>
        &copy; 2025 Ghosty Games. All rights reserved.
        <a href="#">Privacy Policy</a> | <a href="#">Terms of Service</a> | <a href="#">Contact Us</a>
    </footer>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-app.js";
        import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-auth.js";
        import { getFirestore, doc, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDSpebs9nP97-IkXXGALGR2vCqcTTOzlyo",
            authDomain: "ghoatygames.firebaseapp.com",
            projectId: "ghoatygames",
            storageBucket: "ghoatygames.firebasestorage.app",
            messagingSenderId: "606779515816",
            appId: "1:606779515816:web:774ccc3cd8d7f895f7339d",
            measurementId: "G-CCE1LRLR46"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        let username = null;

        onAuthStateChanged(auth, async (user) => {
            if (user) {
                document.getElementById("login-container").style.display = "none";
                document.getElementById("profile-container").style.display = "inline-block";
                document.getElementById("profile-email").textContent = user.email;
                const userRef = doc(db, "leaderboard", user.uid);
                const userSnap = await getDoc(userRef);
                if (userSnap.exists()) {
                    username = userSnap.data().username || null;
                    document.getElementById("profile-btn").textContent = (username || user.email) + " ▼";
                }
            } else {
                document.getElementById("login-container").style.display = "inline-block";
                document.getElementById("profile-container").style.display = "none";
            }
        });

        document.getElementById("profile-btn").addEventListener("click", () => {
            document.getElementById("profile-container").classList.toggle("active");
        });

        document.getElementById("save-username").addEventListener("click", async () => {
            const user = auth.currentUser;
            if (user) {
                username = document.getElementById("username-prefix").value.trim();
                if (username) {
                    try {
                        await setDoc(doc(db, "leaderboard", user.uid), { username: username }, { merge: true });
                        document.getElementById("profile-btn").textContent = username + " ▼";
                        alert("Username saved");
                    } catch (err) {
                        alert("Failed to save username");
                    }
                }
            }
        });

        document.getElementById("logout-button").addEventListener("click", async () => {
            await signOut(auth);
            location.reload();
        });
    </script>
<script type="module" src="session.js"></script>

</body>
</html>